Neural network-driven domain decomposition for efficient solutions to
the Helmholtz equation
Victorita Dolean[0000âˆ’0002âˆ’5885âˆ’1903],
Daria Hrebenshchykova[0009âˆ’0006âˆ’0190âˆ’7052],
StÂ´ephane Lanteri[0000âˆ’0001âˆ’6394âˆ’0487], and
Victor Michel-Dansac[0000âˆ’0002âˆ’3859âˆ’8517]
Abstract Accurately simulating wave propagation is crucial in fields such as acoustics, electromagnetism, and seismic
analysis. Traditional numerical methods, like finite difference and finite element approaches, are widely used to solve
governing partial differential equations (PDEs) such as the Helmholtz equation. However, these methods face significant
computational challenges when applied to high-frequency wave problems in complex two-dimensional domains. This work
investigates Finite Basis Physics-Informed Neural Networks (FBPINNs) and their multilevel extensions as a promising
alternative. These methods leverage domain decomposition, partitioning the computational domain into overlapping sub-
domains, each governed by a local neural network. We assess their accuracy and computational efficiency in solving
the Helmholtz equation for the homogeneous case, demonstrating their potential to mitigate the limitations of traditional
approaches.
1 Introduction
Accurate simulation of wave propagation is crucial in many scientific and engineering applications, where the frequency-
domain Helmholtz equation plays a central role. A particular challenge arises when solving this equation in free space,
since the correct mathematical formulation requires the Sommerfeld radiation condition at infinity. This condition can be
approximated by an absorbing boundary, such as a Robin boundary condition or perfectly matched layers (PMLs). Handling
such open-domain problems accurately is essential to avoid reflections and ensure physically consistent wavefields.
We focus on solving a well-posed time-independent problem, in the form
D[ğ‘¢](x) = ğ‘”(x),
x âˆˆÎ© âŠ‚Rğ‘‘,
(1)
where D is some differential operator, ğ‘¢is the unknown solution and x is the space variable, with Î© being the space domain.
Note that (1) does not contain a boundary operator; this is intentional as boundary condition will be handled by PMLs. To
solve (1), we use Physics-Informed Neural Networks (PINNs) proposed in [6]. PINNs train a Neural Network (NN) to solve a
differential equation by directly approximating the solution, i.e., defining ğ‘£(Â·, ğœ½) â‰ˆğ‘¢(Â·), where ğœ½represents a set of trainable
parameters of the neural network. The main advantages of PINNs are their mesh-free nature and the fact that we end up with
the approximation of a function rather than a discretised solution, unlike conventional numerical methods. Based on [6], the
Victorita Dolean
Department of Mathematics and Computer Science, Eindhoven University of Technology, The Netherlands, e-mail: v.dolean.maini@tue.nl
Daria Hrebenshchykova
Atlantis project-team, Inria Research Center at UniversitÂ´e CË†ote dâ€™Azur, France e-mail: daria.hrebenshchykova@inria.fr
StÂ´ephane Lanteri
Atlantis project-team, Inria Research Center at UniversitÂ´e CË†ote dâ€™Azur, e-mail: stephane.lanteri@inria.fr
Victor Michel-Dansac
MACARON project-team, UniversitÂ´e de Strasbourg, CNRS, Inria, IRMA, France , e-mail: victor.michel-dansac@inria.fr
1
arXiv:2511.15445v1  [math.NA]  19 Nov 2025

2
Dolean V., Hrebenshchykova D., Lanteri S., Michel-Dansac V.
following loss function is minimized to train the PINN
ğ¿(ğœƒ) = 1
ğ‘
ğ‘ğ¼
âˆ‘ï¸
ğ‘–=1
(D[ğ‘£(ğ‘¥ğ‘–, ğœƒ)] âˆ’ğ‘“(ğ‘¥ğ‘–))2
|                        {z                        }
PDE residual
,
(2)
where {ğ‘¥ğ‘–}ğ‘ğ¼
ğ‘–=1 is a set of collocation points sampled in the domain. As mentioned above, we do not include a boundary loss
term here, as the PML formulation ensures wave absorption at the boundaries, removing the necessity for explicit boundary
constraints as in standard PINNs.
We move from the standard PINNs formulation to its domain-decomposed extension, namely the Finite Basis PINNs
(FBPINNs) introduced in [4], which decompose the domain into overlapping subdomains. We want to combine them with
PML to simulate free-space wave propagation. The goal of this work is to assess the performance of the combination of
FBPINNs and PML approach for solving the Helmholtz equation.
2 Mathematical Model
In this work, we consider the frequency-domain Helmholtz equation in free space, given by
âˆ’Î”ğ‘¢(x) âˆ’ğ‘˜2ğ‘¢(x) = ğ‘”(x),
x âˆˆÎ©,
(3)
for x = (ğ‘¥, ğ‘¦)âŠºâˆˆÎ© = Rğ‘‘with ğ‘‘= 2. Here ğ‘˜= 2ğœ‹/ğœ†is the constant (scalar) wavenumber defined by wavelength ğœ†= ğ‘/ğ‘“,
where ğ‘the wave speed and ğ‘“the frequency. The unknown function is ğ‘¢: R2 â†’C and ğ‘”: R2 â†’C is a source function. This
problem naturally falls into the general framework (1). Physically valid solutions satisfy the Sommerfeld radiation condition
at infinity
lim
|x|â†’âˆ|x|
ğ‘‘âˆ’1
2
 ğœ•ğ‘¢
ğœ•|x| âˆ’ğ‘–ğ‘˜ğ‘¢

= 0.
2.1 Perfectly Matched Layer
To approximate the Sommerfeld radiation condition, the problem is reformulated using a PML transformation introduced
by BÂ´erenger [1] in 1994. The PML offers a more robust approximation than e.g. Robin boundary conditions by creating a
finite, artificial absorbing layer around the simulation area.
We are looking for the solution in the region Î© = [âˆ’ğ¿, ğ¿]2, considering a symmetrical domain without loss of generality.
To apply the PML, the computational domain Î© = [âˆ’ğ¿âˆ’ğ¿PML, ğ¿+ ğ¿PML]2, where ğ¿PML represents the width of our
absorbing layer. The computational domain is illustrated in Figure 1 (left), where the blue square corresponds to the physical
region and the red layer represents the PML. At this stage, we consider a single computational domain. The implementation
of a PML uses a coordinate stretching technique, thus, we define the coordinate stretching functions
ğ·ğ‘¥: ğ‘¥â†¦â†’
1
1 âˆ’ğ‘–ğœ(ğ‘¥)
ğ‘˜
and
ğ·ğ‘¦: ğ‘¦â†¦â†’
1
1 âˆ’ğ‘–ğœ(ğ‘¦)
ğ‘˜
.
where
ğœ(ğ‘¥) = ğœ0ğ‘˜
ï£±ï£´ï£´ï£´ï£´ï£´ï£´ï£´ï£²
ï£´ï£´ï£´ï£´ï£´ï£´ï£´ï£³
âˆ’ğ¿âˆ’ğ‘¥
ğ¿PML
2
,
ğ‘¥< âˆ’ğ¿,
0,
âˆ’ğ¿â‰¤ğ‘¥â‰¤ğ¿,
ğ‘¥âˆ’ğ¿
ğ¿PML
2
,
ğ‘¥> ğ¿,
The tuning constant ğœ0 and the PML thickness are specified parameters in the numerical experiments. The function ğœ
is defined following [2, 7], but other choices are also possible. Then, thanks to the absorbing layer, we no longer impose a

N.N.-driven D.D. for Helmholtz equation
3
Fig. 1
Schematic illustration of the computational domains for PINNs (left) and FBPINNs (right) with PML. The blue rectangle denotes the
physical domain Î© where we want to find the solution. The red line indicates the outer boundary of the computational domain, including the PML
region. The PML is thus located between the red and blue boundaries and ensures wave absorption. In the FBPINNs case (right), the physical
domain together with the PML region is further divided into four overlapping subdomains {Î© ğ‘—} ğ‘—âˆˆ{1,...,4}.
boundary condition explicitly, since it is incorporated into the equation itself. As a result, the differential operator with PML
DPML, associated with the Helmholtz equation, defined as
DPML = âˆ’ğ·ğ‘¥
ğœ•
ğœ•ğ‘¥

ğ·ğ‘¥
ğœ•
ğœ•ğ‘¥

âˆ’ğ·ğ‘¦
ğœ•
ğœ•ğ‘¦

ğ·ğ‘¦
ğœ•
ğœ•ğ‘¦

âˆ’ğ‘˜2.
(4)
2.2 FBPINNs
This section defines the mathematical formulation of FBPINNs according to [4]. First, we split the global domain Î© into ğ½
overlapping subdomains {Î© ğ‘—} ğ‘—âˆˆ{1,...,ğ½}. To achieve smoother and more accurate solutions, these subdomains are constructed
with an overlap ğœ‚, which will be specified in the numerical experiments. This overlap is introduced to avoid dealing explicitly
with continuity constraints at subdomain interfaces. The approximate solution to our problem (1) is then defined as
Ëœğ‘¢(x, ğœ½) =
ğ½
âˆ‘ï¸
ğ‘—=1
ğœ‘ğ‘—(x) ğ‘£ğ‘—(x; ğœƒğ‘—),
(5)
where Ëœğ‘¢is the weighted combination of the local neural networks ğ‘£ğ‘—, each trained on its corresponding subdomain Î©ğ‘—.
The window function ğœ‘ğ‘—restricts the influence of ğ‘£ğ‘—to its local subdomain while ensuring a smooth transition between
neighbouring regions.
Each window function must be smooth, differentiable, and form a partition of unity, i.e. Ãğ½
ğ‘—=1 ğœ‘ğ‘—(x) = 1. Like in [3], we
use a cosine-based window function
ğœ‘ğ‘—(x) =
Ë†ğœ‘ğ‘—(x)
Ãğ½
ğ‘š=1 Ë†ğœ‘ğ‘š(x)
,
where
Ë†ğœ‘ğ‘—(x) =
2
Ã–
ğ‘›=1

1 + cos

ğœ‹ğ‘¥ğ‘›âˆ’ğœ‡ğ‘—,ğ‘›
ğœ“ğ‘—,ğ‘›
2
.
Here, ğœ‡ğ‘—,ğ‘›denotes the centre of the ğ‘—-th subdomain along the ğ‘›-th spatial axis, and ğœ“ğ‘—,ğ‘›= ğœ‚Î”ğ‘›/2 defines its half-width, with
Î”ğ‘›the subdomain size along dimension ğ‘›.
The FBPINNs loss function is based on (2), but now combined with PML, we no longer include the boundary residual
term, since the PML formulation ensures wave absorption at the boundaries. Consequently, the computational domain
becomes the extended region Î©PML, and the standard differential operator D is replaced by the PML operator DPML defined
in (4). The general structure of the FBPINNs combined with PML is shown in Figure 1 (right), where the global domain,

4
Dolean V., Hrebenshchykova D., Lanteri S., Michel-Dansac V.
including the PML, is partitioned into four overlapping subdomains. Given the ansatz defined by (5), the loss function
accounting for both FBPINNs and PML takes the following form
ğ¿(ğœ½) = 1
ğ‘
ğ‘
âˆ‘ï¸
ğ‘–=1
(DPML[ Ëœğ‘¢(ğ‘¥ğ‘–, ğœ½)] âˆ’ğ‘”(ğ‘¥ğ‘–))2 .
(6)
3 Numerical Results
In this section we present numerical results for 2D Helmholtz problem with a Gaussian point source ğ‘”(ğ‘¥, ğ‘¦) = ğ‘’âˆ’ğ‘˜(ğ‘¥2+ğ‘¦2)
in the domain Î© = [âˆ’5, 5]2. In our tests, we set the wave speed ğ‘= 1 and vary the frequency ğ‘“such that the wavenumber
ğ‘˜= 2ğœ‹/ğœ†does not coincide with the eigenfrequencies of the domain, ensuring the existence and uniqueness of the solution.
We vary the PML width based on the wavelength ğœ†= 2ğœ‹/ğ‘˜, specifically 0.25ğœ†, 0.5ğœ†and ğœ†. To ensure that subdomains
overlap, the overlap ratio must satisfy ğœ‚> 1. If it is smaller then 1, the subdomains remain disjoint. In our tests we use an
overlap ğœ‚= 1.5. To help the network find the correct solution for the imaginary part of the problem, we start training with
an incorrect source term for the imaginary part that contains small oscillations with frequency ğ‘˜. After a few epochs, we
replace the source term with the correct one, which is zero in our case.
Some PINNs and FBPINNs settings and hyperparameters are fixed across all experiments. Specifically, we use a learning
rate of 0.001, a standart multilayer perceptron, 5000 collocation points and sine activation function. We divide the domain
into four subdomains when using FBPINNs.
We compare the Adam + L-BFGS optimization technique with the Energy Natural Gradient Descent (ENGD) method.
Adam and L-BFGS are state-of-the-art optimizers for training PINNs, commonly used in the literature due to their reliability
and convergence properties. ENGD introduced in [5] modifies the standard gradient update as follows
ğœƒğ‘¡+1 = ğœƒğ‘¡âˆ’ğºâˆ’1
ğ¸(ğœƒğ‘¡) âˆ‡ğœƒğ¿(ğœƒğ‘¡),
where ğºğ¸(ğœƒ) = âˆ‡ğœƒğ¿(ğœƒ)âŠ¤âˆ‡ğœƒğ¿(ğœƒ) is the energy matrix derived from the physical energy functional
ğ¿(ğœƒ) = ğ¸(ğ‘¢ğœƒ) =
âˆ«
Î©
(Dğ‘¢âˆ’ğ‘”)2 dğ‘¥.
This approach takes into account the shape of the loss surface when updating the parameters. For experiments with ENGD
and Adam optimizer in combination with L-BFGS, where L-BFGS is initiated at a training ratio of 0.7, we use the architecture
3 hidden layers with 32 neurons each for PINNs and 3 hidden layers with 16 neurons in every layer for each NN of FBPINNs.
To evaluate the effect of domain decomposition, we compare the performance of standard PINNs and FBPINNs for
different wavenumbers and PML thicknesses. In Tables 1 and 2, we report the relative ğ¿2 error, defined by
ğœ€ğ¿2 = âˆ¥ğ‘¢approx âˆ’ğ‘¢refâˆ¥2
âˆ¥ğ‘¢refâˆ¥2
,
where ğ‘¢approx and ğ‘¢ref represent the approximate and reference solutions, respectively. We compute the errors for the real
and the imaginary parts separately.
From the Table 1 we can see that both methods perform similarly at low frequencies (ğ‘˜= 0.57) for both methods of
optimizations. However, as the wavenumber increases, the standard PINNs quickly deteriorate, showing errors close to unity
already for ğ‘˜= 4.51, while the FBPINNs maintain a slightly better accuracy. We can observe a similar situation with the
imaginary part from Table 2, but by comparing the results, we can conclude that despite our assistance to the imaginary
part in the form of preliminary training with another source term, it is still approximated worse than the real part. We
assume that this effect appears because there is a local minimum where the imaginary part tends to vanish, which makes the
optimization harder for this part. The difference between PINNs and FBPINNs is clearly visible in the convergence curves in
Figure 2, where the FBPINNs show a faster decrease in loss and achieve a lower final value, especially for high frequencies.
Nevertheless, when the wight of PML is too thin (for example ğ¿PML = 0.25ğœ†), both approaches struggle to converge due to
insufficient wave absorption at the boundaries.
We also compare the performance of the standard Adam + L-BFGS optimizer with the ENGD.

N.N.-driven D.D. for Helmholtz equation
5
Table 1 Relative ğ¿2 error between real part of approximate and reference solutions for different ğ¿PML, comparing PINNs and FBPINNs
performance using (a) Adam + L-BFGS and (b) ENGD.
(a) Adam + L-BFGS optimizer
Method
ğ‘˜
0.25ğœ†
0.5ğœ†
1.0ğœ†
PINNs
0.57 5.6eâ€“2 1.6eâ€“2 4.0eâ€“3
1.59 4.0eâ€“1 2.9eâ€“2 2.2eâ€“2
4.51 9.1eâ€“1 9.7eâ€“1 9.7eâ€“1
FBPINNs 0.57 4.1eâ€“2 1.5eâ€“2 7.3eâ€“3
1.59 3.0eâ€“1 1.6eâ€“2 1.1eâ€“2
4.51 9.3eâ€“1 9.3eâ€“1 9.5eâ€“1
(b) ENGD optimizer
Method
ğ‘˜
0.25ğœ†
0.5ğœ†
1.0ğœ†
PINNs
0.57 1.7eâ€“1 1.0eâ€“2 5.4eâ€“3
1.59 6.7eâ€“1 1.8eâ€“2 4.9eâ€“3
4.51 6.7eâ€“1 3.0eâ€“1 1.4eâ€“2
FBPINNs 0.57 7.3eâ€“1 6.1eâ€“3 3.3eâ€“3
1.59 8.7eâ€“1 1.5eâ€“2 4.1eâ€“3
4.51 6.4eâ€“1 1.7eâ€“1 1.1eâ€“2
Table 2 Relative ğ¿2 error between imaginary part of approximate and reference solutions for different ğ¿PML, comparing PINNs and FBPINNs
performance using (a) Adam + L-BFGS and (b) ENGD.
(a) Adam + L-BFGS optimizer
Method
ğ‘˜
0.25ğœ†
0.5ğœ†
1.0ğœ†
PINNs
0.57 1.0eâ€“1 2.0eâ€“2 6.2eâ€“3
1.59 6.4eâ€“1 2.7eâ€“1 8.8eâ€“1
4.51 1.0e+0 1.0e+0 1.0e+0
FBPINNs 0.57 5.6eâ€“1 2.7eâ€“2 1.8eâ€“3
1.59 5.1eâ€“1 5.9eâ€“2 3.3eâ€“2
4.51 1.0e+0 1.0e+0 1.0e+0
(b) ENGD optimizer
Method
ğ‘˜
0.25ğœ†
0.5ğœ†
1.0ğœ†
PINNs
0.57 2.7eâ€“1 1.4eâ€“2 1.8eâ€“3
1.59 8.5eâ€“1 2.4eâ€“2 1.4eâ€“3
4.51 9.0eâ€“1 4.7eâ€“1 8.2eâ€“2
FBPINNs 0.57 5.9eâ€“1 1.3eâ€“2 1.3eâ€“3
1.59 6.1eâ€“1 2.0eâ€“2 1.3eâ€“3
4.51 9.0eâ€“1 3.7eâ€“1 1.6eâ€“2
At low frequencies, both optimizers provide similar results, although ENGD demonstrating faster stabilization of the loss
that we can see from Figure 2. As the frequency increases, the difference becomes clearer: while the standard optimizer
struggles to converge, ENGD succeeds in maintaining stable training and correctly reproducing the oscillatory solution. From
the real and imaginary part approximations shown in Figure 3, we observed that ENGD captures the fine wave structures
missed by Adam + L-BFGS, even in the imaginary part. Regarding the errors reported in Tables 1 and 2, the results are most
evident when we move to the frequency of ğ‘˜= 4.5, since in this case, especially for the imaginary part, Adam + L-BFGS
gives the worst error, while ENGD achieve an accurate approximation. The training speed of ENGD is about six times lower
than that of Adam + L-BFGS for both PINNs and FBPINNs. This is mainly due to the additional computation of the energy
matrix at each iteration, which significantly increases the computational cost. The use of double precision arithmetic further
contributes to the slowdown. In practice, switching to hardware that handles double precision more efficiently could reduce
this gap, although the method would still remain slower overall.

6
Dolean V., Hrebenshchykova D., Lanteri S., Michel-Dansac V.
Fig. 2 Normalized physics loss during training for Adam + L-BFGS (left) and ENGD (right). Rows correspond to different ğ‘˜and curves compare
PINNs vs FBPINNs across PML thicknesses.
Fig. 3 Approximation and reference solutions of the real and imaginary parts for the Helmholtz problem with ğ‘˜= 4.51 comparing ADAM+L-
BFGS and ENGD optimization methods for PINNs and FBPINNs.

N.N.-driven D.D. for Helmholtz equation
7
4 Conclusion
In this work, we showed that FBPINNs combined with PML boundaries can effectively handle wave absorption and provide
more accurate solutions than standard PINNs. While the improvement remains moderate, the obtained results confirm that
the approach is effective and has potential for further refinement. The use of natural gradient preconditioning also helped to
stabilize training and achieve better convergence. In future work, we plan to refine the combination of FBPINNs and PML
by introducing internal absorbing layers and to extend the framework toward multilevel FBPINNs as in [3] for more complex
wave problems (higher frequencies, heterogeneous media, . . . ).
Acknowledgements As part of the â€œFrance 2030â€ initiative, this work has benefited from a national grant managed by the French National
Research Agency (Agence Nationale de la Recherche) attributed to the Exa-MA project of the NumPEx PEPR program, under the reference
ANR-22-EXNU-0002.
Competing Interests The authors have no conflicts of interest to declare that are relevant to the content of this chapter.
References
1. J.-P. BÂ´erenger (1994) A perfectly matched layer for the absorption of electromagnetic waves. J. Comput. Phys. 114(2):185â€“200.
2. N. Bootland, S. Borzooei, V. Dolean, P.-H. Tournier (2024) Numerical assessment of PML transmission conditions in a domain decomposition
method for the Helmholtz equation. In: DostÂ´al Z et al. (eds) Domain decomposition methods in science and engineering XXVII. Lecture
notes in computational science and engineering, vol 149. Springer, Cham, pp 445â€“453.
3. V. Dolean, A. Heinlein, S. Mishra, B. Moseley (2024) Multilevel domain decomposition-based architectures for physics-informed neural
networks. Comput. Method. Appl. M. 429.
4. B. Moseley, A. Markham, T. Nissen-Meyer (2023) Finite basis physics-informed neural networks (FBPINNs): A scalable domain decompo-
sition approach for solving differential equations. Adv. Comput. Math. 49(4):1â€“39.
5. J. Muller, M. Zeinhofer (2023) Achieving High Accuracy with PINNs via Energy Natural Gradient Descent. Proceedings of the 40 th
International Conference on Machine Learning, Honolulu, Hawaii, USA. PMLR 202
6. M. Raissi, P. Perdikaris, G. E. Karniadakis (2019) Physics-informed neural networks: A deep learning framework for solving forward and
inverse problems involving nonlinear partial differential equations. J. Comput. Phys. 378:686â€“707.
7. C. Song, T. Alkhalifah, U. B. Waheed (2021) A versatile framework to solve the Helmholtz equation using physics-informed neural networks.
Geophys. J. Int. 228(3):1750-1762.
